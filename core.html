<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pattaasu Kadai</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* General Body and Font Styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9;
            color: #1f2937;
            margin: 0;
        }

        /* Container for centering content */
        .container {
            width: 100%;
            max-width: 1280px;
            margin-left: auto;
            margin-right: auto;
            padding: 1.5rem;
        }

        /* Header Styles */
        .header {
            background-color: #ffffff;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.05);
            position: sticky;
            top: 0;
            z-index: 50;
        }
        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 4rem; /* 64px */
        }
        .logo-container {
            display: flex;
            align-items: center;
            gap: 0.75rem; /* 12px */
        }
        .logo-icon {
            height: 2rem; /* 32px */
            width: 2rem; /* 32px */
            color: #ef4444; /* red-500 */
        }
        .header-title {
            font-size: 1.25rem; /* 20px */
            font-weight: 700;
        }

        /* Navigation Styles */
        .navigation {
            display: flex;
            align-items: center;
            gap: 1rem; /* 16px */
        }
        .nav-link {
            font-weight: 600;
            color: #6b7280; /* gray-500 */
            border: none;
            background: none;
            cursor: pointer;
            padding: 0.5rem 0.75rem;
            border-bottom: 2px solid transparent;
        }
        .nav-link:hover {
            color: #ef4444; /* red-600 */
        }
        .nav-link.active {
            color: #ef4444; /* red-600 */
            border-bottom-color: #ef4444; /* red-600 */
        }
        
        /* Main and View Sections */
        .main-content {
            padding-top: 1rem;
            padding-bottom: 1rem;
        }
        .view-section {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }
        .view-section.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Enquiry Page "PDF" Look */
        #enquiry-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        #enquiry-header .logo-container {
            justify-content: center;
        }
        #enquiry-header .logo-icon {
            height: 3rem;
            width: 3rem;
        }
        #enquiry-header .header-title {
            font-size: 2.25rem; /* 36px */
        }
        #enquiry-header .sub-title {
            color: #4b5563; /* gray-600 */
            margin-top: 0.5rem;
        }

        /* Admin Panel Styles */
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        .page-title {
            font-size: 1.5rem; /* 24px */
            font-weight: 700;
        }
        .button {
            font-weight: 700;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem; /* 8px */
            transition: background-color 0.2s;
            border: none;
            cursor: pointer;
        }
        .button-primary {
            background-color: #ef4444; /* red-500 */
            color: #ffffff;
        }
        .button-primary:hover {
            background-color: #dc2626; /* red-600 */
        }
        .button-secondary {
            background-color: #d1d5db; /* gray-300 */
            color: #1f2937; /* gray-800 */
        }
        .button-secondary:hover {
            background-color: #9ca3af; /* gray-400 */
        }
        
        /* Table Styles */
        .table-container {
            background-color: #ffffff;
            padding: 1rem;
            border-radius: 0.5rem; /* 8px */
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            overflow-x: auto;
        }
        .product-list-container {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        .category-title {
            font-size: 1.25rem; /* 20px */
            font-weight: 700;
            margin-bottom: 0.75rem;
            border-bottom: 2px solid #fee2e2; /* red-200 */
            padding-bottom: 0.5rem;
        }
        .custom-table {
            width: 100%;
            text-align: left;
            border-collapse: collapse;
        }
        .custom-table thead {
            background-color: #f9fafb; /* gray-50 */
        }
        .custom-table th, .custom-table td {
            padding: 0.75rem;
            font-size: 0.875rem; /* 14px */
        }
        .custom-table th {
            font-weight: 600;
        }
        .custom-table tbody tr {
            border-bottom: 1px solid #e5e7eb; /* gray-200 */
        }
        .custom-table tbody tr:hover {
            background-color: #f9fafb; /* gray-50 */
        }
        .product-image {
            width: 4rem; /* 64px */
            height: 4rem; /* 64px */
            object-fit: cover;
            border-radius: 0.375rem; /* 6px */
        }
        .product-image-sm {
            width: 3rem; /* 48px */
            height: 3rem; /* 48px */
            object-fit: cover;
            border-radius: 0.375rem; /* 6px */
        }
        .price-original {
            color: #6b7280; /* gray-500 */
            text-decoration: line-through;
        }
        .price-offer {
            font-weight: 700;
            color: #dc2626; /* red-600 */
        }
        .price-increased { color: #22c55e; /* green-500 */ }
        .price-decreased { color: #ef4444; /* red-500 */ }
        .action-button {
            color: #ef4444; /* red-500 */
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 500;
        }
        .action-button:hover {
            color: #b91c1c; /* red-700 */
        }
        .editable-price {
            font-weight: 600;
        }
        .editable-price-input {
            width: 80px;
            padding: 4px;
            border: 1px solid #3b82f6;
            border-radius: 4px;
            text-align: center;
        }
        
        /* Modal Styles */
        .modal-backdrop {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 0.5rem;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .modal-title {
            font-size: 1.25rem; /* 20px */
            font-weight: 700;
            margin-bottom: 1rem;
        }
        .modal-form .form-group {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .form-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #d1d5db; /* gray-300 */
            border-radius: 0.375rem; /* 6px */
        }
        .file-input-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151; /* gray-700 */
            margin-bottom: 0.25rem;
        }
        #image-preview {
            margin-top: 1rem;
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 0.375rem;
            border: 1px solid #e5e7eb;
        }
        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>

    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo-container">
                    <svg class="logo-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15.362 5.214A8.252 8.252 0 0112 21 8.25 8.25 0 016.038 7.048l5.962-5.962a.75.75 0 011.06 1.06l-5.962 5.962A6.75 6.75 0 0012 19.5a6.75 6.75 0 005.362-10.952l-5.962 5.962a.75.75 0 01-1.06-1.06l5.962-5.962z" />
                    </svg>
                    <h1 class="header-title">Pattaasu Kadai</h1>
                </div>
                <nav class="navigation">
                    <button id="nav-enquiry" class="nav-link active">Enquiry</button>
                    <button id="nav-admin" class="nav-link">Admin</button>
                </nav>
            </div>
        </div>
    </header>

    <main class="container main-content">
        <section id="enquiry-view" class="view-section active">
            <div id="enquiry-header">
                <div class="logo-container">
                     <svg class="logo-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15.362 5.214A8.252 8.252 0 0112 21 8.25 8.25 0 016.038 7.048l5.962-5.962a.75.75 0 011.06 1.06l-5.962 5.962A6.75 6.75 0 0012 19.5a6.75 6.75 0 005.362-10.952l-5.962 5.962a.75.75 0 01-1.06-1.06l5.962-5.962z" />
                    </svg>
                    <h1 class="header-title">Pattaasu Kadai</h1>
                </div>
                 <p class="sub-title">Price List</p>
            </div>
            
            <div id="product-list" class="product-list-container">
                </div>
        </section>

        <section id="admin-view" class="view-section">
            <div class="admin-header">
                <h2 class="page-title">Admin Panel - Manage Products</h2>
                <button id="add-product-btn" class="button button-primary">Add New Product</button>
            </div>
            <div class="table-container">
                <table class="custom-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Image</th>
                            <th>English Name</th>
                            <th>Tamil Name</th>
                            <th>Original Price</th>
                            <th>Offer Price</th>
                            <th>Category</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="admin-table-body">
                        </tbody>
                </table>
            </div>
        </section>
    </main>

    <div id="product-modal" class="modal-backdrop hidden">
        <div class="modal-content">
            <h3 id="modal-title" class="modal-title">Add New Product</h3>
            <form id="product-form" class="modal-form">
                <input type="hidden" id="product-id">
                <div class="form-group">
                    <input type="text" id="product-name" placeholder="English Name" class="form-input" required>
                    <input type="text" id="product-tamil-name" placeholder="Tamil Name" class="form-input" required>
                    
                    <div>
                        <label for="product-image-upload" class="file-input-label">Product Image</label>
                        <input type="file" id="product-image-upload" class="form-input" accept="image/*" required>
                        <img id="image-preview" src="" alt="Image Preview" class="hidden">
                    </div>

                    <input type="number" id="product-original-price" placeholder="Original Price (₹)" class="form-input" required>
                    <input type="number" id="product-offer-price" placeholder="Offer Price (₹)" class="form-input" required>
                    <input type="text" id="product-category" placeholder="Category" class="form-input" required>
                </div>
                <div class="modal-actions">
                    <button type="button" id="cancel-btn" class="button button-secondary">Cancel</button>
                    <button type="submit" id="save-btn" class="button button-primary">Save Product</button>
                </div>
            </form>
        </div>
    </div>


    <script>
    document.addEventListener('DOMContentLoaded', () => {

        // --- DATA ---
        const initialProducts = [
            { id: 1, name: '100 Wala Garland', tamilName: '100 வாலா சரம்', originalPrice: 150, offerPrice: 135, category: 'Garlands (சரங்கள்)', image: 'https://placehold.co/100x100/ef4444/ffffff?text=Garland', priceHistory: [135] },
            { id: 2, name: '28 Wala Giant Crackers', tamilName: '28 வாலா ஜெயின்ட்', originalPrice: 200, offerPrice: 180, category: 'Garlands (சரங்கள்)', image: 'https://placehold.co/100x100/ef4444/ffffff?text=Garland', priceHistory: [180] },
            { id: 3, name: '5000 Wala Garland', tamilName: '5000 வாலா சரம்', originalPrice: 2500, offerPrice: 2250, category: 'Garlands (சரங்கள்)', image: 'https://placehold.co/100x100/ef4444/ffffff?text=Garland', priceHistory: [2250] },
            { id: 4, name: 'Red Sparklers', tamilName: 'சிகப்பு மத்தாப்பு', originalPrice: 60, offerPrice: 50, category: 'Sparklers (மத்தாப்பு)', image: 'https://placehold.co/100x100/facc15/333333?text=Sparkler', priceHistory: [50] },
            { id: 5, name: 'Green Sparklers', tamilName: 'பச்சை மத்தாப்பு', originalPrice: 60, offerPrice: 50, category: 'Sparklers (மத்தாப்பு)', image: 'https://placehold.co/100x100/facc15/333333?text=Sparkler', priceHistory: [50] },
            { id: 6, name: 'Flower Pots (Small)', tamilName: 'பூந்தொட்டி (சிறியது)', originalPrice: 80, offerPrice: 70, category: 'Flower Pots (பூந்தொட்டி)', image: 'https://placehold.co/100x100/22c55e/ffffff?text=Pot', priceHistory: [70] },
            { id: 7, name: 'Flower Pots (Big)', tamilName: 'பூந்தொட்டி (பெரியது)', originalPrice: 120, offerPrice: 105, category: 'Flower Pots (பூந்தொட்டி)', image: 'https://placehold.co/100x100/22c55e/ffffff?text=Pot', priceHistory: [105] },
            { id: 8, name: 'Ground Chakkar (Small)', tamilName: 'சங்கு சக்கரம் (சிறியது)', originalPrice: 75, offerPrice: 65, category: 'Chakkars (சக்கரம்)', image: 'https://placehold.co/100x100/3b82f6/ffffff?text=Chakkar', priceHistory: [65] },
            { id: 9, name: 'Ground Chakkar (Big)', tamilName: 'சங்கு சக்கரம் (பெரியது)', originalPrice: 110, offerPrice: 95, category: 'Chakkars (சக்கரம்)', image: 'https://placehold.co/100x100/3b82f6/ffffff?text=Chakkar', priceHistory: [95] },
            { id: 10, name: '7 Shot Sky Fire', tamilName: '7 ஷாட் வானவேடிக்கை', originalPrice: 300, offerPrice: 270, category: 'Sky Shots (வானவேடிக்கை)', image: 'https://placehold.co/100x100/8b5cf6/ffffff?text=Shot', priceHistory: [270] },
            { id: 11, name: '12 Shot Sky Fire', tamilName: '12 ஷாட் வானவேடிக்கை', originalPrice: 450, offerPrice: 400, category: 'Sky Shots (வானவேடிக்கை)', image: 'https://placehold.co/100x100/8b5cf6/ffffff?text=Shot', priceHistory: [400] },
            { id: 12, name: 'Bijili Crackers', tamilName: 'பிஜிலி வெடி', originalPrice: 40, offerPrice: 35, category: 'Crackers (வெடி)', image: 'https://placehold.co/100x100/f97316/ffffff?text=Cracker', priceHistory: [35] },
            { id: 13, name: 'Kuruvi VEDI', tamilName: 'குருவி வெடி', originalPrice: 30, offerPrice: 25, category: 'Crackers (வெடி)', image: 'https://placehold.co/100x100/f97316/ffffff?text=Cracker', priceHistory: [25] },
            { id: 14, name: 'Rocket Bomb', tamilName: 'ராக்கெட் பாம்', originalPrice: 180, offerPrice: 160, category: 'Rockets (ராக்கெட்)', image: 'https://placehold.co/100x100/14b8a6/ffffff?text=Rocket', priceHistory: [160] },
            { id: 15, name: '2 Sound Rocket', tamilName: '2 சவுண்ட் ராக்கெட்', originalPrice: 220, offerPrice: 200, category: 'Rockets (ராக்கெட்)', image: 'https://placehold.co/100x100/14b8a6/ffffff?text=Rocket', priceHistory: [200] },
            { id: 16, name: 'Whistling Rocket', tamilName: 'விசில் ராக்கெட்', originalPrice: 150, offerPrice: 130, category: 'Rockets (ராக்கெட்)', image: 'https://placehold.co/100x100/14b8a6/ffffff?text=Rocket', priceHistory: [130] },
            { id: 17, name: 'Color Changing Butterfly', tamilName: 'வண்ணத்துப்பூச்சி', originalPrice: 90, offerPrice: 80, category: 'Fancy Items', image: 'https://placehold.co/100x100/d946ef/ffffff?text=Fancy', priceHistory: [80] },
            { id: 18, name: 'Magic Stick', tamilName: 'மேஜிக் ஸ்டிக்', originalPrice: 50, offerPrice: 40, category: 'Fancy Items', image: 'https://placehold.co/100x100/d946ef/ffffff?text=Fancy', priceHistory: [40] },
            { id: 19, name: 'Hydro Bomb', tamilName: 'ஹைட்ரோ பாம்', originalPrice: 250, offerPrice: 225, category: 'Crackers (வெடி)', image: 'https://placehold.co/100x100/f97316/ffffff?text=Cracker', priceHistory: [225] },
            { id: 20, name: '24 Deluxe Shot', tamilName: '24 டீலக்ஸ் ஷாட்', originalPrice: 700, offerPrice: 630, category: 'Sky Shots (வானவேடிக்கை)', image: 'https://placehold.co/100x100/8b5cf6/ffffff?text=Shot', priceHistory: [630] },
            { id: 21, name: 'Color Flower Pots', tamilName: 'கலர் பூந்தொட்டி', originalPrice: 150, offerPrice: 130, category: 'Flower Pots (பூந்தொட்டி)', image: 'https://placehold.co/100x100/22c55e/ffffff?text=Pot', priceHistory: [130] },
            { id: 22, name: 'Electric Sparklers', tamilName: 'எலக்ட்ரிக் மத்தாப்பு', originalPrice: 100, offerPrice: 90, category: 'Sparklers (மத்தாப்பு)', image: 'https://placehold.co/100x100/facc15/333333?text=Sparkler', priceHistory: [90] },
            { id: 23, name: '1000 Wala Garland', tamilName: '1000 வாலா சரம்', originalPrice: 500, offerPrice: 450, category: 'Garlands (சரங்கள்)', image: 'https://placehold.co/100x100/ef4444/ffffff?text=Garland', priceHistory: [450] },
            { id: 24, name: 'Mega Chakkar', tamilName: 'மெகா சக்கரம்', originalPrice: 150, offerPrice: 135, category: 'Chakkars (சக்கரம்)', image: 'https://placehold.co/100x100/3b82f6/ffffff?text=Chakkar', priceHistory: [135] },
            { id: 25, name: 'Atom Bomb', tamilName: 'அணுகுண்டு', originalPrice: 90, offerPrice: 80, category: 'Crackers (வெடி)', image: 'https://placehold.co/100x100/f97316/ffffff?text=Cracker', priceHistory: [80] },
            { id: 26, name: '30 Shot Multi Color', tamilName: '30 ஷாட் மல்டி கலர்', originalPrice: 850, offerPrice: 765, category: 'Sky Shots (வானவேடிக்கை)', image: 'https://placehold.co/100x100/8b5cf6/ffffff?text=Shot', priceHistory: [765] },
            { id: 27, name: 'Parachute Rocket', tamilName: 'பாராசூட் ராக்கெட்', originalPrice: 200, offerPrice: 180, category: 'Rockets (ராக்கெட்)', image: 'https://placehold.co/100x100/14b8a6/ffffff?text=Rocket', priceHistory: [180] },
            { id: 28, name: 'Snake Eggs', tamilName: 'பாம்பு மாத்திரை', originalPrice: 20, offerPrice: 15, category: 'Fancy Items', image: 'https://placehold.co/100x100/d946ef/ffffff?text=Fancy', priceHistory: [15] },
            { id: 29, name: 'Jil Jil', tamilName: 'ஜில் ஜில்', originalPrice: 60, offerPrice: 55, category: 'Fancy Items', image: 'https://placehold.co/100x100/d946ef/ffffff?text=Fancy', priceHistory: [55] },
            { id: 30, name: 'Red Fort', tamilName: 'செங்கோட்டை', originalPrice: 400, offerPrice: 350, category: 'Fancy Items', image: 'https://placehold.co/100x100/d946ef/ffffff?text=Fancy', priceHistory: [350] },
            { id: 31, name: '200 Wala Garland', tamilName: '200 வாலா சரம்', originalPrice: 280, offerPrice: 250, category: 'Garlands (சரங்கள்)', image: 'https://placehold.co/100x100/ef4444/ffffff?text=Garland', priceHistory: [250] },
            { id: 32, name: 'Jumbo Sparklers', tamilName: 'ஜம்போ மத்தாப்பு', originalPrice: 120, offerPrice: 100, category: 'Sparklers (மத்தாப்பு)', image: 'https://placehold.co/100x100/facc15/333333?text=Sparkler', priceHistory: [100] },
            { id: 33, name: 'Crackling Flower Pots', tamilName: 'சிடசிட பூந்தொட்டி', originalPrice: 130, offerPrice: 115, category: 'Flower Pots (பூந்தொட்டி)', image: 'https://placehold.co/100x100/22c55e/ffffff?text=Pot', priceHistory: [115] },
            { id: 34, name: 'Spinner Chakkar', tamilName: 'ஸ்பின்னர் சக்கரம்', originalPrice: 100, offerPrice: 90, category: 'Chakkars (சக்கரம்)', image: 'https://placehold.co/100x100/3b82f6/ffffff?text=Chakkar', priceHistory: [90] },
            { id: 35, 'name': '50 Shot Comet', tamilName: '50 ஷாட் வால்மீன்', originalPrice: 1200, offerPrice: 1080, category: 'Sky Shots (வானவேடிக்கை)', image: 'https://placehold.co/100x100/8b5cf6/ffffff?text=Shot', priceHistory: [1080] },
            { id: 36, 'name': 'Lakshmi VEDI', tamilName: 'லட்சுமி வெடி', originalPrice: 50, offerPrice: 45, category: 'Crackers (வெடி)', image: 'https://placehold.co/100x100/f97316/ffffff?text=Cracker', priceHistory: [45] },
            { id: 37, 'name': '4 Sound Rocket', tamilName: '4 சவுண்ட் ராக்கெட்', originalPrice: 300, offerPrice: 270, category: 'Rockets (ராக்கெட்)', image: 'https://placehold.co/100x100/14b8a6/ffffff?text=Rocket', priceHistory: [270] },
            { id: 38, 'name': 'Photo Flash', tamilName: 'போட்டோ பிளாஷ்', originalPrice: 70, offerPrice: 60, category: 'Fancy Items', image: 'https://placehold.co/100x100/d946ef/ffffff?text=Fancy', priceHistory: [60] },
            { id: 39, 'name': '2000 Wala Garland', tamilName: '2000 வாலா சரம்', originalPrice: 1000, offerPrice: 900, category: 'Garlands (சரங்கள்)', image: 'https://placehold.co/100x100/ef4444/ffffff?text=Garland', priceHistory: [900] },
            { id: 40, 'name': 'Color Smoke Fountain', tamilName: 'கலர் புகை', originalPrice: 150, offerPrice: 135, category: 'Fancy Items', image: 'https://placehold.co/100x100/d946ef/ffffff?text=Fancy', priceHistory: [135] }
        ];

        let products = JSON.parse(localStorage.getItem('crackerProducts')) || initialProducts;
        let newProductImageBase64 = '';

        // --- DOM Elements ---
        const navEnquiry = document.getElementById('nav-enquiry');
        const navAdmin = document.getElementById('nav-admin');
        const enquiryView = document.getElementById('enquiry-view');
        const adminView = document.getElementById('admin-view');
        const productList = document.getElementById('product-list');
        const adminTableBody = document.getElementById('admin-table-body');
        const addProductBtn = document.getElementById('add-product-btn');
        const productModal = document.getElementById('product-modal');
        const modalTitle = document.getElementById('modal-title');
        const productForm = document.getElementById('product-form');
        const cancelBtn = document.getElementById('cancel-btn');
        const imageUploadInput = document.getElementById('product-image-upload');
        const imagePreview = document.getElementById('image-preview');

        // --- Functions ---

        const saveProducts = () => {
            localStorage.setItem('crackerProducts', JSON.stringify(products));
        };

        const renderEnquiryList = () => {
            productList.innerHTML = '';
            if (products.length === 0) {
                productList.innerHTML = `<p style="text-align: center; color: #6b7280;">No products available.</p>`;
                return;
            }

            const productsByCategory = products.reduce((acc, product) => {
                (acc[product.category] = acc[product.category] || []).push(product);
                return acc;
            }, {});

            Object.keys(productsByCategory).sort().forEach(category => {
                const categoryContainer = document.createElement('div');
                categoryContainer.innerHTML = `<h3 class="category-title">${category}</h3>`;
                
                const tableContainer = document.createElement('div');
                tableContainer.className = 'table-container';

                const table = document.createElement('table');
                table.className = 'custom-table';
                table.innerHTML = `
                    <thead>
                        <tr>
                            <th>Image</th>
                            <th>English Name</th>
                            <th>Tamil Name</th>
                            <th>Original Price</th>
                            <th>Offer Price</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                `;

                const tbody = table.querySelector('tbody');
                productsByCategory[category].forEach(product => {
                    const row = document.createElement('tr');
                    
                    let priceIndicator = '';
                    let priceClass = '';
                    if (product.priceHistory && product.priceHistory.length > 1) {
                        const currentPrice = product.priceHistory[product.priceHistory.length - 1];
                        const prevPrice = product.priceHistory[product.priceHistory.length - 2];
                        if (currentPrice > prevPrice) { // Price Increased
                            priceClass = 'price-increased';
                            priceIndicator = `<span class="price-increased" style="margin-left: 0.5rem;">↑</span>`; 
                        } else if (currentPrice < prevPrice) { // Price Decreased
                            priceClass = 'price-decreased';
                            priceIndicator = `<span class="price-decreased" style="margin-left: 0.5rem;">↓</span>`;
                        }
                    }

                    row.innerHTML = `
                        <td><img src="${product.image}" alt="${product.name}" class="product-image" onerror="this.onerror=null;this.src='https://placehold.co/100x100/cccccc/ffffff?text=NoImg';"></td>
                        <td>${product.name}</td>
                        <td>${product.tamilName}</td>
                        <td class="price-original">₹${product.originalPrice}</td>
                        <td class="price-offer ${priceClass}">₹${product.offerPrice} ${priceIndicator}</td>
                    `;
                    tbody.appendChild(row);
                });

                tableContainer.appendChild(table);
                categoryContainer.appendChild(tableContainer);
                productList.appendChild(categoryContainer);
            });
        };

        const renderAdminTable = () => {
            adminTableBody.innerHTML = '';
            products.forEach(product => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${product.id}</td>
                    <td><img src="${product.image}" alt="${product.name}" class="product-image-sm" onerror="this.onerror=null;this.src='https://placehold.co/100x100/cccccc/ffffff?text=NoImg';"></td>
                    <td>${product.name}</td>
                    <td>${product.tamilName}</td>
                    <td>₹${product.originalPrice}</td>
                    <td class="editable-price" data-id="${product.id}">₹${product.offerPrice}</td>
                    <td>${product.category}</td>
                    <td>
                        <button class="action-button delete-btn" data-id="${product.id}">Delete</button>
                    </td>
                `;
                adminTableBody.appendChild(row);
            });
            document.querySelectorAll('.delete-btn').forEach(btn => btn.addEventListener('click', handleDelete));
        };
        
        const switchView = (view) => {
            if (view === 'admin') {
                adminView.classList.add('active');
                enquiryView.classList.remove('active');
                navAdmin.classList.add('active');
                navEnquiry.classList.remove('active');
                renderAdminTable();
            } else {
                enquiryView.classList.add('active');
                adminView.classList.remove('active');
                navEnquiry.classList.add('active');
                navAdmin.classList.remove('active');
                renderEnquiryList();
            }
        };

        const showModal = () => {
            productForm.reset();
            modalTitle.textContent = 'Add New Product';
            document.getElementById('product-id').value = '';
            newProductImageBase64 = ''; // Reset image data
            imagePreview.classList.add('hidden');
            imagePreview.src = '';
            productModal.classList.remove('hidden');
        };

        const hideModal = () => {
            productModal.classList.add('hidden');
        };

        const handleFormSubmit = (e) => {
            e.preventDefault();

            if (!newProductImageBase64) {
                alert('Please upload an image.');
                return;
            }

            const newProductData = {
                name: document.getElementById('product-name').value,
                tamilName: document.getElementById('product-tamil-name').value,
                image: newProductImageBase64,
                originalPrice: parseFloat(document.getElementById('product-original-price').value),
                offerPrice: parseFloat(document.getElementById('product-offer-price').value),
                category: document.getElementById('product-category').value,
            };

            const newId = products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1;
            products.push({ 
                id: newId, 
                ...newProductData,
                priceHistory: [newProductData.offerPrice]
            });

            saveProducts();
            renderAdminTable();
            renderEnquiryList();
            hideModal();
        };

        const handleDelete = (e) => {
            const id = e.target.dataset.id;
            if (confirm('Indha product-ai neekka venduma?')) {
                products = products.filter(p => p.id != id);
                saveProducts();
                renderAdminTable();
                renderEnquiryList();
            }
        };

        const handlePriceEdit = (e) => {
            if (!e.target.classList.contains('editable-price')) return;

            const cell = e.target;
            const currentText = cell.textContent;
            const currentPrice = parseFloat(currentText.replace('₹', ''));
            const productId = cell.dataset.id;
            
            if(cell.querySelector('input')) return; // Prevent double-triggering

            cell.innerHTML = ''; 

            const input = document.createElement('input');
            input.type = 'number';
            input.value = currentPrice;
            input.className = 'editable-price-input';

            input.addEventListener('blur', finishEditing);
            input.addEventListener('keydown', (evt) => {
                if (evt.key === 'Enter') {
                    input.blur();
                } else if (evt.key === 'Escape') {
                    cell.textContent = currentText;
                }
            });

            cell.appendChild(input);
            input.focus();

            function finishEditing() {
                const newValue = parseFloat(input.value);
                if (!isNaN(newValue) && newValue > 0) {
                     const productIndex = products.findIndex(p => p.id == productId);
                     if (productIndex > -1) {
                        const oldPrice = products[productIndex].offerPrice;
                        if (oldPrice !== newValue) {
                            products[productIndex].offerPrice = newValue;
                            if (!products[productIndex].priceHistory) {
                                products[productIndex].priceHistory = [];
                            }
                            products[productIndex].priceHistory.push(newValue);
                        }
                        saveProducts();
                        cell.textContent = `₹${newValue}`;
                        renderEnquiryList();
                     } else {
                        cell.textContent = currentText;
                     }
                } else {
                    cell.textContent = currentText;
                }
            }
        };

        const handleImageUpload = (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    newProductImageBase64 = event.target.result;
                    imagePreview.src = newProductImageBase64;
                    imagePreview.classList.remove('hidden');
                }
                reader.readAsDataURL(file);
            }
        }


        // --- Event Listeners ---
        navEnquiry.addEventListener('click', () => switchView('enquiry'));
        navAdmin.addEventListener('click', () => switchView('admin'));
        addProductBtn.addEventListener('click', showModal);
        cancelBtn.addEventListener('click', hideModal);
        productForm.addEventListener('submit', handleFormSubmit);
        imageUploadInput.addEventListener('change', handleImageUpload);
        adminTableBody.addEventListener('dblclick', handlePriceEdit);


        // --- Initial Load ---
        switchView('enquiry');
    });
    </script>

</body>
</html>